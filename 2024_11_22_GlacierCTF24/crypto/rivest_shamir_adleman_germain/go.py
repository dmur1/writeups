#!/usr/bin/env python3

from z3 import *

n = 489654925303072532553659432557377999607856370197579144782976005904927235244321459117898721690940319487769632950077647476152880207627385231603017537961906244964117707813500615680799967895028255666319186794462243666159201392490299439947399915406223652423977002396844720487588735149486903743362109592536081726574342051928022071576485169655694281378301551060632699138055044915993078059902577590451519251321215765308977494770310317350866241246677761542212605478044672014913289740381478940929584556588858045439572693806615268502627912952686133840081188641597461343817750411035667135310831687533531094008308185320371643348451
c = 58535947031303233853656030097871859886777764034955095086618901763996192727846608049414977429851683454541344096765319691912454768331685486037922533236779909508856486986528041125267338846421238077083738092020495236946742989769815669001100361743526446503248639704900983287986142636083524250650662602975802778548032518674346903013262799229594298599457623347987250272218522320743415393958131916181915804368140008312975210397791293701839101635851486434802271100141743496402698229558250485987421664294229816166263965806962242894230766553316312608696594536239328785792283453559549564751529321240567418095487324718881437825650
e = 0x10001

p = Int("p")
q = Int("q")
r = Int("r")
s = Int("s")

solver = Solver()

solver.add((p % 2) == 1)
solver.add((p * q * r * s) == n)
solver.add(q == ((2*p) + 1))
solver.add(r == ((2*q) + 1))
solver.add(s == ((2*r) + 1))

solver.check()
model = solver.model()

p = model[p].as_long()
q = model[q].as_long()
r = model[r].as_long()
s = model[s].as_long()

assert((p * q * r * s) == n)

phi = (p - 1) * (q - 1) * (r - 1) * (s - 1)
d = pow(e, -1, phi)
m = pow(c, d, n)
flag = m.to_bytes(length=(m.bit_length() + 7) // 8, byteorder="big").decode()
print(flag) # gctf{54dly_50ph13_63rm41n_pr1m35_wh3r3_n07_u53d_53curly}
