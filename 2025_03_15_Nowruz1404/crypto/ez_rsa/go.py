#!/usr/bin/env python3

from z3 import *

e = 65537
hint = 17469292153344571442220879753705314094982989674618803961044325274734902918518047825543639089360378046111761829828690097867206972174713085299385569035446604
n = 72178676992512160441554160179592383158203955928083976740488546189244761660478121450369459709272987174826935459768807973546852656122370605905453926547673003297830819475396600384101353650933279529161854454268770358323854195264696322371766082303954604264551309576730976571309522883511488619775495703381232031179
c = 58920849369961001974878540043377399205173235403895163231084588694712964281923344842680972991777380071418111292770515352012869237864259800540355713208626735820573601770413846338478651482053989341163751620131823006414875347921150338651475973491744075397194132475674270761198474531891598902225518350430719735601

p = Int("p")
q = Int("q")

s = Solver()

s.add(p > 0, q > 0)
s.add(p < n, q < n)
s.add((p * q) == n)
s.add((p + q) == hint)

s.check()
model = s.model()

p = int(str(model[p]))
print(f"{p = }") # 10763282340819802385678039958673293220920907157068453240201038306905350526601967771732592841865361970392579490032623710197052104436183215008801113590798347

q = int(str(model[q]))
print(f"{q = }") # 10763282340819802385678039958673293220920907157068453240201038306905350526601967771732592841865361970392579490032623710197052104436183215008801113590798347

assert((p * q) == n)

phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)
m = pow(c, d, n)

flag = m.to_bytes(length=(m.bit_length() + 7) // 8, byteorder="big")
print(flag.decode()) # FMCTF{rSA_34SY_P34SY_L3M0N_5QU33ZY}
